<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç©åˆ†ã‚¬ãƒãƒ£</title>

<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$']] },
  startup: { typeset: false }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>

<style>
body { font-family: system-ui, sans-serif; background:#f5f5f5; padding:16px; }
.container { max-width:480px; margin:auto; background:#fff; padding:16px; border-radius:12px; }
button, select { width:100%; padding:12px; font-size:1.1rem; margin-top:10px; }
button { background:#4f46e5; color:#fff; border:none; border-radius:8px; }
button.sub { background:#16a34a; }
.box { margin-top:16px; font-size:1.2rem; min-height:2em; }
</style>
</head>

<body>
<div class="container">
  <h1>ğŸ² ç©åˆ†ã‚¬ãƒãƒ£</h1>

  <select id="level">
    <option value="easy">â˜… æ˜“ã—ã„</option>
    <option value="normal">â˜…â˜… æ™®é€š</option>
    <option value="hard">â˜…â˜…â˜… é›£ã—ã„</option>
  </select>

  <button id="spinBtn">ã‚¬ãƒãƒ£ã‚’å›ã™</button>
  <button id="ansBtn" class="sub">ç­”ãˆã‚’è¡¨ç¤º / éè¡¨ç¤º</button>

  <div id="q" class="box"></div>
  <div id="a" class="box" style="display:none;"></div>
</div>

<script>
/* ===== å…±é€š ===== */
function randInt(a, b) {
  return Math.floor(Math.random() * (b - a + 1)) + a;
}

/* ===== ç©åˆ†ç”Ÿæˆï¼ˆæ—¢å­˜ä»•æ§˜ãã®ã¾ã¾ï¼‰===== */
function generate(level) {

  // easy
  if (level === "easy") {
    const t = randInt(1, 3);
    const a = randInt(1, 5);

    if (t === 1)
      return { q:`\\int \\sin(${a}x)\\,dx`,
               a:`-\\frac{1}{${a}}\\cos(${a}x)+C` };

    if (t === 2)
      return { q:`\\int \\cos(${a}x)\\,dx`,
               a:`\\frac{1}{${a}}\\sin(${a}x)+C` };

    return { q:`\\int \\frac{1}{x}\\,dx`,
             a:`\\log|x|+C` };
  }

  // normal
  if (level === "normal") {
    const t = randInt(1, 2);

    if (t === 1)
      return { q:`\\int_1^e \\log x\\,dx`,
               a:`1` };

    const a = randInt(1, 4);
    return { q:`\\int_0^\\pi \\sin(${a}x)\\,dx`,
             a:`\\frac{2}{${a}}` };
  }

  // hard
  const a = randInt(1, 3);
  return {
    q:`\\int_0^\\pi x\\sin(${a}x)\\,dx`,
    a:`\\frac{\\pi}{${a}}`
  };
}

/* ===== é€šå¸¸ã‚¬ãƒãƒ£ ===== */
function spin() {
  const level = document.getElementById("level").value;
  const p = generate(level);

  document.getElementById("question").innerHTML = `$$${p.q}$$`;
  document.getElementById("answer").innerHTML = `$$${p.a}$$`;
  document.getElementById("answer").style.display = "none";

  MathJax.typeset();
}

/* ===== 5å•å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ï¼ˆeasy2 normal2 hard1ï¼‰===== */
let studyIndex = 0;
const studyLevels = ["easy", "easy", "normal", "normal", "hard"];

function startStudy() {
  studyIndex = 0;
  nextStudy();
}

function nextStudy() {
  if (studyIndex >= studyLevels.length) {
    document.getElementById("question").innerHTML =
      "ğŸ‰ 5å•çµ‚äº†ï¼ãŠã¤ã‹ã‚Œã•ã¾";
    document.getElementById("answer").style.display = "none";
    MathJax.typeset();
    return;
  }

  const level = studyLevels[studyIndex];
  const p = generate(level);

  document.getElementById("question").innerHTML =
    `ã€${studyIndex + 1}/5ï½œ${level.toUpperCase()}ã€‘<br>$$${p.q}$$`;
  document.getElementById("answer").innerHTML = `$$${p.a}$$`;
  document.getElementById("answer").style.display = "none";

  studyIndex++;
  MathJax.typeset();
}

/* ===== ç­”ãˆè¡¨ç¤º ===== */
function toggleAnswer() {
  const a = document.getElementById("answer");

  if (a.style.display === "none") {
    a.style.display = "block";
  } else {
    a.style.display = "none";
    nextStudy();
  }
}
</script>

</body>
</html>
